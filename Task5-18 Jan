Function comp-details
{
param ( 
[parameter(mandatory=$true,position=0)] $comp, [parameter(mandatory=$true,position=1)] $Drive
)


begin {
}
process {
Get-WmiObject win32_logicaldisk -ComputerName $comp -Filter $Drive | where {($_.Freespace /$_.size) -lt 1} | Select DeviceID,@{Name="FreeSpace"; Expression={$_.FreeSpace/1GB}},@{Name="size"; Expression={$_.size/1GB}} | Export-Csv -path "d:\report.csv" -Force -Append -NoTypeInformation
}
End {
}
}

comp-details localhost drivetype=3
